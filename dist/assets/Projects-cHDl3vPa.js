import{_ as J,r as m,i as K,o as L,c as Q,b as e,w as a,d as s,h as v,E as _,j as W,e as X,f as p,t as P,a as U,v as Z}from"./index-B4OK-yx2.js";const h={class:"projects"},ee={class:"card-header"},te={__name:"Projects",setup(le){const Y=W(),b=m([]),y=m(1),$=m(20),V=m(0),d=m(!1),f=m(null),n=K({name:"",description:"",status:"planning",priority:"medium",start_date:"",end_date:""}),M=o=>({planning:"info",active:"success",paused:"warning",completed:"success"})[o]||"info",T=o=>({planning:"规划中",active:"进行中",paused:"已暂停",completed:"已完成"})[o]||o,B=o=>({low:"info",medium:"",high:"warning",urgent:"danger"})[o]||"",D=o=>({low:"低",medium:"中",high:"高",urgent:"紧急"})[o]||o,g=async()=>{try{const o=await v.get("/api/projects/",{params:{page:y.value}});b.value=o.data.results||[],V.value=o.data.count||0}catch{_.error("加载项目列表失败")}},E=o=>{Y.push(`/projects/${o}`)},S=o=>{f.value=o,Object.assign(n,o),d.value=!0},z=async()=>{try{f.value?(await v.put(`/api/projects/${f.value.id}/`,n),_.success("项目更新成功")):(await v.post("/api/projects/",n),_.success("项目创建成功")),d.value=!1,g()}catch{_.error("保存失败")}},N=async o=>{try{await Z.confirm("确定要删除此项目吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await v.delete(`/api/projects/${o.id}/`),_.success("项目删除成功"),g()}catch(t){t!=="cancel"&&_.error("删除失败")}};return L(()=>{g()}),(o,t)=>{const q=s("Plus"),F=s("el-icon"),i=s("el-button"),r=s("el-table-column"),w=s("el-tag"),I=s("el-progress"),O=s("el-table"),R=s("el-pagination"),A=s("el-card"),x=s("el-input"),c=s("el-form-item"),u=s("el-option"),j=s("el-select"),k=s("el-date-picker"),G=s("el-form"),H=s("el-dialog");return X(),Q("div",h,[e(A,null,{header:a(()=>[U("div",ee,[t[11]||(t[11]=U("h3",null,"项目列表",-1)),e(i,{type:"primary",onClick:t[0]||(t[0]=l=>d.value=!0)},{default:a(()=>[e(F,null,{default:a(()=>[e(q)]),_:1}),t[10]||(t[10]=p(" 新建项目 ",-1))]),_:1})])]),default:a(()=>[e(O,{data:b.value,stripe:""},{default:a(()=>[e(r,{prop:"name",label:"项目名称","min-width":"200"}),e(r,{prop:"owner_name",label:"负责人",width:"120"}),e(r,{prop:"status",label:"状态",width:"100"},{default:a(({row:l})=>[e(w,{type:M(l.status)},{default:a(()=>[p(P(T(l.status)),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"priority",label:"优先级",width:"100"},{default:a(({row:l})=>[e(w,{type:B(l.priority)},{default:a(()=>[p(P(D(l.priority)),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"progress",label:"进度",width:"120"},{default:a(({row:l})=>[e(I,{percentage:l.progress},null,8,["percentage"])]),_:1}),e(r,{prop:"start_date",label:"开始日期",width:"120"}),e(r,{prop:"end_date",label:"结束日期",width:"120"}),e(r,{label:"操作",width:"150",fixed:"right"},{default:a(({row:l})=>[e(i,{link:"",type:"primary",onClick:C=>E(l.id)},{default:a(()=>[...t[12]||(t[12]=[p("查看",-1)])]),_:1},8,["onClick"]),e(i,{link:"",type:"primary",onClick:C=>S(l)},{default:a(()=>[...t[13]||(t[13]=[p("编辑",-1)])]),_:1},8,["onClick"]),e(i,{link:"",type:"danger",onClick:C=>N(l)},{default:a(()=>[...t[14]||(t[14]=[p("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),e(R,{"current-page":y.value,"onUpdate:currentPage":t[1]||(t[1]=l=>y.value=l),"page-size":$.value,total:V.value,layout:"total, prev, pager, next",onCurrentChange:g},null,8,["current-page","page-size","total"])]),_:1}),e(H,{modelValue:d.value,"onUpdate:modelValue":t[9]||(t[9]=l=>d.value=l),title:f.value?"编辑项目":"新建项目",width:"600px"},{footer:a(()=>[e(i,{onClick:t[8]||(t[8]=l=>d.value=!1)},{default:a(()=>[...t[15]||(t[15]=[p("取消",-1)])]),_:1}),e(i,{type:"primary",onClick:z},{default:a(()=>[...t[16]||(t[16]=[p("保存",-1)])]),_:1})]),default:a(()=>[e(G,{model:n,"label-width":"100px"},{default:a(()=>[e(c,{label:"项目名称",required:""},{default:a(()=>[e(x,{modelValue:n.name,"onUpdate:modelValue":t[2]||(t[2]=l=>n.name=l)},null,8,["modelValue"])]),_:1}),e(c,{label:"项目描述"},{default:a(()=>[e(x,{modelValue:n.description,"onUpdate:modelValue":t[3]||(t[3]=l=>n.description=l),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),e(c,{label:"状态"},{default:a(()=>[e(j,{modelValue:n.status,"onUpdate:modelValue":t[4]||(t[4]=l=>n.status=l)},{default:a(()=>[e(u,{label:"规划中",value:"planning"}),e(u,{label:"进行中",value:"active"}),e(u,{label:"已暂停",value:"paused"}),e(u,{label:"已完成",value:"completed"})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"优先级"},{default:a(()=>[e(j,{modelValue:n.priority,"onUpdate:modelValue":t[5]||(t[5]=l=>n.priority=l)},{default:a(()=>[e(u,{label:"低",value:"low"}),e(u,{label:"中",value:"medium"}),e(u,{label:"高",value:"high"}),e(u,{label:"紧急",value:"urgent"})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"开始日期"},{default:a(()=>[e(k,{modelValue:n.start_date,"onUpdate:modelValue":t[6]||(t[6]=l=>n.start_date=l),type:"date","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(c,{label:"结束日期"},{default:a(()=>[e(k,{modelValue:n.end_date,"onUpdate:modelValue":t[7]||(t[7]=l=>n.end_date=l),type:"date","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},oe=J(te,[["__scopeId","data-v-5a0c7896"]]);export{oe as default};
