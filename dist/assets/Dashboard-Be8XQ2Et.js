import{_ as N,r as g,o as S,c as p,b as s,w as e,d as c,h as b,e as r,a as t,t as l,q as x,F as P,s as C,f as j}from"./index-B4OK-yx2.js";const V={class:"dashboard"},$={class:"stats-content"},O={class:"stats-value"},R={class:"stats-content"},W={class:"stats-value"},q={class:"stats-content"},E={class:"stats-value"},I={class:"stats-content"},M={class:"stats-value"},z={key:1},A=["onClick"],G={class:"project-name"},H={class:"project-meta"},J={key:1},K={class:"task-title"},Q={class:"task-meta"},U={__name:"Dashboard",setup(X){const u=g({totalProjects:0,totalTasks:0,inProgressTasks:0,overdueTasks:0}),f=g([]),m=g([]),k=d=>({planning:"info",active:"success",in_progress:"warning",completed:"success",paused:"warning",cancelled:"danger"})[d]||"info",h=d=>({planning:"规划中",active:"进行中",in_progress:"进行中",completed:"已完成",paused:"已暂停",cancelled:"已取消",todo:"待办",review:"待审核"})[d]||d,B=async()=>{var d,a,v;try{const i=await b.get("/api/projects/");f.value=((d=i.data.results)==null?void 0:d.slice(0,5))||[],u.value.totalProjects=i.data.count||0;const n=await b.get("/api/tasks/");m.value=((a=n.data.results)==null?void 0:a.slice(0,5))||[],u.value.totalTasks=n.data.count||0,u.value.inProgressTasks=((v=n.data.results)==null?void 0:v.filter(_=>_.status==="in_progress").length)||0}catch(i){console.error("加载数据失败:",i)}};return S(()=>{B()}),(d,a)=>{const v=c("FolderOpened"),i=c("el-icon"),n=c("el-card"),_=c("el-col"),D=c("List"),F=c("Clock"),L=c("Warning"),y=c("el-row"),T=c("el-empty"),w=c("el-tag");return r(),p("div",V,[s(y,{gutter:20},{default:e(()=>[s(_,{span:6},{default:e(()=>[s(n,{class:"stats-card"},{default:e(()=>[t("div",$,[s(i,{class:"stats-icon",color:"#409eff"},{default:e(()=>[s(v)]),_:1}),t("div",null,[t("div",O,l(u.value.totalProjects),1),a[0]||(a[0]=t("div",{class:"stats-label"},"总项目数",-1))])])]),_:1})]),_:1}),s(_,{span:6},{default:e(()=>[s(n,{class:"stats-card"},{default:e(()=>[t("div",R,[s(i,{class:"stats-icon",color:"#67c23a"},{default:e(()=>[s(D)]),_:1}),t("div",null,[t("div",W,l(u.value.totalTasks),1),a[1]||(a[1]=t("div",{class:"stats-label"},"总任务数",-1))])])]),_:1})]),_:1}),s(_,{span:6},{default:e(()=>[s(n,{class:"stats-card"},{default:e(()=>[t("div",q,[s(i,{class:"stats-icon",color:"#e6a23c"},{default:e(()=>[s(F)]),_:1}),t("div",null,[t("div",E,l(u.value.inProgressTasks),1),a[2]||(a[2]=t("div",{class:"stats-label"},"进行中任务",-1))])])]),_:1})]),_:1}),s(_,{span:6},{default:e(()=>[s(n,{class:"stats-card"},{default:e(()=>[t("div",I,[s(i,{class:"stats-icon",color:"#f56c6c"},{default:e(()=>[s(L)]),_:1}),t("div",null,[t("div",M,l(u.value.overdueTasks),1),a[3]||(a[3]=t("div",{class:"stats-label"},"逾期任务",-1))])])]),_:1})]),_:1})]),_:1}),s(y,{gutter:20,style:{"margin-top":"20px"}},{default:e(()=>[s(_,{span:12},{default:e(()=>[s(n,null,{header:e(()=>[...a[4]||(a[4]=[t("h3",null,"最近项目",-1)])]),default:e(()=>[f.value.length===0?(r(),x(T,{key:0,description:"暂无项目"})):(r(),p("div",z,[(r(!0),p(P,null,C(f.value,o=>(r(),p("div",{key:o.id,class:"project-item",onClick:Y=>d.$router.push(`/projects/${o.id}`)},[t("div",null,[t("div",G,l(o.name),1),t("div",H,l(o.owner_name)+" · "+l(o.created_at),1)]),s(w,{type:k(o.status)},{default:e(()=>[j(l(h(o.status)),1)]),_:2},1032,["type"])],8,A))),128))]))]),_:1})]),_:1}),s(_,{span:12},{default:e(()=>[s(n,null,{header:e(()=>[...a[5]||(a[5]=[t("h3",null,"我的任务",-1)])]),default:e(()=>[m.value.length===0?(r(),x(T,{key:0,description:"暂无任务"})):(r(),p("div",J,[(r(!0),p(P,null,C(m.value,o=>(r(),p("div",{key:o.id,class:"task-item"},[t("div",null,[t("div",K,l(o.title),1),t("div",Q,l(o.project_name)+" · "+l(o.due_date||"无截止日期"),1)]),s(w,{type:k(o.status)},{default:e(()=>[j(l(h(o.status)),1)]),_:2},1032,["type"])]))),128))]))]),_:1})]),_:1})]),_:1})])}}},ss=N(U,[["__scopeId","data-v-11869564"]]);export{ss as default};
